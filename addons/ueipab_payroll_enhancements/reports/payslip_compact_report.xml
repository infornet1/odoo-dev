<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Compact Payslip Report Template -->
    <template id="report_payslip_compact">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-set="report" t-value="reports[o_index]"/>
                <t t-call="web.basic_layout">
                    <div class="page" style="font-size: 7pt; font-family: Arial, sans-serif;">

                        <!-- TITLE + PAYSLIP INFO -->
                        <div style="text-align: center; margin-bottom: 10px; border-bottom: 2px solid #333; padding-bottom: 8px;">
                            <h3 style="font-size: 11pt; margin: 0 0 5px 0; font-weight: bold;">
                                COMPROBANTE DE PAGO - UEIPAB
                            </h3>
                            <p style="font-size: 7pt; margin: 0; color: #666;">
                                Nro: <strong><t t-esc="report['payslip'].number"/></strong> │
                                Período: <strong><t t-esc="report['payslip'].date_from.strftime('%B %Y').title()"/></strong>
                            </p>

                            <!-- Exchange rate display (only for VEB) -->
                            <t t-if="report.get('exchange') and report['exchange'].get('display_rate')">
                                <p style="font-size: 6.5pt; margin: 3px 0 0 0; color: #666;">
                                    <t t-if="report['exchange']['rate_source']">
                                        <t t-esc="report['exchange']['rate_source']"/>:
                                    </t>
                                    <strong><t t-esc="'%.4f' % report['exchange']['rate_value']"/> VEB/USD</strong>
                                </p>
                            </t>
                        </div>

                        <!-- EMPLOYEE INFO TABLE (2x4 grid) -->
                        <table class="table table-sm table-bordered" style="margin-bottom: 10px; font-size: 7pt;">
                            <tbody>
                                <tr>
                                    <td style="width: 25%; background-color: #f8f9fa; font-weight: bold; padding: 4px;">Empleado:</td>
                                    <td style="width: 25%; padding: 4px;"><t t-esc="report['employee']['name']"/></td>
                                    <td style="width: 25%; background-color: #f8f9fa; font-weight: bold; padding: 4px;">Cédula:</td>
                                    <td style="width: 25%; padding: 4px;"><t t-esc="report['employee']['identification_id']"/></td>
                                </tr>
                                <tr>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Cargo:</td>
                                    <td style="padding: 4px;"><t t-esc="report['employee']['job']"/></td>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Departamento:</td>
                                    <td style="padding: 4px;"><t t-esc="report['employee']['department']"/></td>
                                </tr>
                                <tr>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Salario:</td>
                                    <td style="padding: 4px;"><t t-esc="report['salary_formatted']"/></td>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Fecha Ingreso:</td>
                                    <td style="padding: 4px;"><t t-esc="report['employee']['date_start']"/></td>
                                </tr>
                                <tr>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Período:</td>
                                    <td style="padding: 4px;"><t t-esc="report['employee']['period']"/></td>
                                    <td style="background-color: #f8f9fa; font-weight: bold; padding: 4px;">Banco:</td>
                                    <td style="padding: 4px;"><t t-esc="report['employee']['bank']"/></td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- SECTION 1: DEVENGOS (EARNINGS) - GREEN -->
                        <div style="margin-bottom: 10px;">
                            <h5 style="background-color: #4CAF50; color: white; padding: 4px 8px; font-size: 8pt; margin: 0 0 3px 0; font-weight: bold;">
                                1. DEVENGOS (INGRESOS)
                            </h5>
                            <table class="table table-sm table-bordered" style="font-size: 6.5pt; margin-bottom: 0;">
                                <thead style="background-color: #e8f5e9;">
                                    <tr>
                                        <th style="width: 5%; text-align: center; padding: 3px;">#</th>
                                        <th style="width: 50%; padding: 3px;">Concepto</th>
                                        <th style="width: 20%; text-align: center; padding: 3px;">Cantidad</th>
                                        <th style="width: 25%; text-align: right; padding: 3px;">Monto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="report['earnings']">
                                        <t t-foreach="report['earnings']" t-as="earning">
                                            <tr>
                                                <td style="text-align: center; padding: 3px;"><t t-esc="earning['number']"/></td>
                                                <td style="padding: 3px;"><strong><t t-esc="earning['name']"/></strong></td>
                                                <td style="text-align: center; padding: 3px;"><t t-esc="'%.2f' % earning['quantity']"/></td>
                                                <td style="text-align: right; padding: 3px;"><t t-esc="earning['amount_formatted']"/></td>
                                            </tr>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <tr>
                                            <td colspan="4" style="text-align: center; padding: 5px; color: #999;">
                                                No hay devengos para mostrar
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="background-color: #e8f5e9; font-weight: bold;">
                                        <td colspan="3" style="text-align: right; padding: 4px;">SUBTOTAL DEVENGOS:</td>
                                        <td style="text-align: right; padding: 4px;"><t t-esc="report['earnings_total_formatted']"/></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- SECTION 2: DEDUCCIONES (DEDUCTIONS) - RED -->
                        <div style="margin-bottom: 10px;">
                            <h5 style="background-color: #f44336; color: white; padding: 4px 8px; font-size: 8pt; margin: 0 0 3px 0; font-weight: bold;">
                                2. DEDUCCIONES
                            </h5>
                            <table class="table table-sm table-bordered" style="font-size: 6.5pt; margin-bottom: 0;">
                                <thead style="background-color: #ffebee;">
                                    <tr>
                                        <th style="width: 5%; text-align: center; padding: 3px;">#</th>
                                        <th style="width: 50%; padding: 3px;">Concepto</th>
                                        <th style="width: 20%; text-align: center; padding: 3px;">Tasa</th>
                                        <th style="width: 25%; text-align: right; padding: 3px;">Monto</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-if="report['deductions']">
                                        <t t-foreach="report['deductions']" t-as="deduction">
                                            <tr>
                                                <td style="text-align: center; padding: 3px;"><t t-esc="deduction['number']"/></td>
                                                <td style="padding: 3px;"><strong><t t-esc="deduction['name']"/></strong></td>
                                                <td style="text-align: center; padding: 3px;"><t t-esc="deduction['rate']"/></td>
                                                <td style="text-align: right; padding: 3px;"><t t-esc="deduction['amount_formatted']"/></td>
                                            </tr>
                                        </t>
                                    </t>
                                    <t t-else="">
                                        <tr>
                                            <td colspan="4" style="text-align: center; padding: 5px; color: #999;">
                                                No hay deducciones para mostrar
                                            </td>
                                        </tr>
                                    </t>
                                    <tr style="background-color: #ffebee; font-weight: bold;">
                                        <td colspan="3" style="text-align: right; padding: 4px;">TOTAL DEDUCCIONES:</td>
                                        <td style="text-align: right; padding: 4px;">(<t t-esc="report['deductions_total_formatted']"/>)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- FINAL SUMMARY BOX -->
                        <div style="margin-top: 12px; margin-bottom: 12px; border: 2px solid #333; padding: 10px; background-color: #f8f9fa;">
                            <table style="width: 100%; font-size: 8pt;">
                                <tbody>
                                    <tr>
                                        <td style="width: 70%; text-align: right; padding: 3px 10px;"><strong>TOTAL DEVENGOS:</strong></td>
                                        <td style="width: 30%; text-align: right; padding: 3px 10px;"><t t-esc="report['earnings_total_formatted']"/></td>
                                    </tr>
                                    <tr>
                                        <td style="text-align: right; padding: 3px 10px;"><strong>TOTAL DEDUCCIONES:</strong></td>
                                        <td style="text-align: right; padding: 3px 10px;">(<t t-esc="report['deductions_total_formatted']"/>)</td>
                                    </tr>
                                    <tr style="border-top: 2px solid #333;">
                                        <td style="text-align: right; padding: 8px 10px 3px 10px; font-size: 9pt;"><strong>NETO A PAGAR:</strong></td>
                                        <td style="text-align: right; padding: 8px 10px 3px 10px; font-size: 10pt; font-weight: bold;">
                                            <t t-esc="report['net_pay_formatted']"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- SIGNATURES SECTION -->
                        <div style="margin-top: 25px;">
                            <table style="width: 100%; font-size: 7pt;">
                                <tbody>
                                    <tr>
                                        <td style="width: 50%; text-align: center; vertical-align: bottom; padding-right: 20px;">
                                            <div style="border-top: 1px solid #000; margin-top: 45px; padding-top: 5px;">
                                                <strong>Firma del Empleado</strong><br/>
                                                <small>Fecha: ____/____/______</small>
                                            </div>
                                        </td>
                                        <td style="width: 50%; text-align: center; vertical-align: bottom; padding-left: 20px;">
                                            <div style="border-top: 1px solid #000; margin-top: 45px; padding-top: 5px;">
                                                <strong>Recursos Humanos UEIPAB</strong><br/>
                                                <small>Firma Autorizada</small>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>
