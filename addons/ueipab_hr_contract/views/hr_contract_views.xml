<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Extend HR Contract Form View for Venezuelan Payroll -->
        <record id="hr_contract_view_form_venezuelan" model="ir.ui.view">
            <field name="name">hr.contract.form.venezuelan</field>
            <field name="model">hr.contract</field>
            <field name="inherit_id" ref="hr_contract.hr_contract_view_form"/>
            <field name="priority">99</field>
            <field name="arch" type="xml">
                <!-- Add V1 Venezuelan fields to yearly_benefits (backward compatibility) -->
                <group name="yearly_benefits" position="inside">
                    <field name="ueipab_salary_base" string="Salary (70%)"/>
                    <field name="ueipab_bonus_regular" string="Bonus (25%)"/>
                    <field name="ueipab_extra_bonus" string="Extra Bonus (5%)"/>
                </group>

                <!-- Add new notebook pages after "Salary Information" page -->
                <page name="information" position="after">

                    <!-- Page 1: Salary Breakdown (V2) -->
                    <page string="ðŸ’¼ Salary Breakdown" name="salary_breakdown_v2">
                        <group string="V2 Compensation Breakdown (CEO Approved 2025-11-16)">
                            <group>
                                <field name="ueipab_salary_v2" string="Salary V2 (Deductible)"/>
                                <field name="ueipab_extrabonus_v2" string="Extra Bonus V2"/>
                                <field name="ueipab_bonus_v2" string="Bonus V2"/>
                            </group>
                            <group>
                                <field name="cesta_ticket_usd" string="Cesta Ticket (USD)"/>
                                <separator/>
                                <field name="wage" string="Total Wage (Auto-calculated)" readonly="1"/>
                            </group>
                        </group>
                        <group>
                            <group>
                                <separator string="Deduction Rules"/>
                                <div class="o_form_label">Salary V2: Subject to SSO 4%, FAOV 1%, PARO 0.5%, ARI (variable %)</div>
                                <div class="o_form_label">Extra Bonus V2: Exempt from all deductions</div>
                                <div class="o_form_label">Bonus V2: Exempt from all deductions</div>
                                <div class="o_form_label">Cesta Ticket: Exempt from all deductions</div>
                            </group>
                            <group>
                                <separator string="Proration Formula"/>
                                <div class="o_form_label">Monthly deduction Ã— (payslip_days / 30.0)</div>
                                <div class="o_form_label">Example (15 days): SSO = salary_v2 Ã— 4% Ã— (15/30)</div>
                            </group>
                        </group>
                    </page>

                    <!-- Page 2: Salary Tax Breakdown -->
                    <page string="ðŸ’° Salary Tax Breakdown" name="salary_tax_breakdown">
                        <group string="Venezuelan Withholding Income Tax (ARI)">
                            <group>
                                <field name="ueipab_ari_withholding_rate" string="ARI Rate (%)"/>
                                <field name="ueipab_ari_last_update" string="Last Updated"/>
                            </group>
                            <group>
                                <separator string="ARI Information"/>
                                <div class="o_form_label">Monthly rate applied to Salary V2 only</div>
                                <div class="o_form_label">Prorated by actual payslip period (days/30)</div>
                                <div class="o_form_label">Updated quarterly per Venezuelan tax regulations</div>
                            </group>
                        </group>
                    </page>

                    <!-- Page 3: Salary Liquidation -->
                    <page string="ðŸ“‹ Salary Liquidation" name="salary_liquidation">
                        <group string="Liquidation Historical Tracking">
                            <group>
                                <field name="ueipab_original_hire_date" string="Original Hire Date"/>
                                <field name="ueipab_previous_liquidation_date" string="Previous Liquidation"/>
                                <field name="ueipab_vacation_paid_until" string="Vacation Paid Until"/>
                                <field name="ueipab_vacation_prepaid_amount" string="Vacation/Bono Prepaid"/>
                            </group>
                            <group>
                                <separator string="Field Descriptions"/>
                                <div class="o_form_label">Original Hire Date: First day of employment for antiguedad calculation</div>
                                <div class="o_form_label">Previous Liquidation: Last full settlement date (if rehired)</div>
                                <div class="o_form_label">Vacation Paid Until: Last Aug 1 vacation payment date (tracking only)</div>
                                <div class="o_form_label">Vacation/Bono Prepaid: Total $ amount paid in advance (e.g., $88.98, $256.82)</div>
                            </group>
                        </group>
                    </page>

                    <!-- Page 4: Salary Parameters -->
                    <page string="âš™ï¸ Salary Parameters" name="salary_parameters">
                        <group string="Payroll Schedule Configuration">
                            <group>
                                <field name="bimonthly_payroll" string="Bi-monthly Payroll"/>
                                <field name="first_payment_day" string="1st Payment Day"/>
                                <field name="second_payment_day" string="2nd Payment Day"/>
                            </group>
                            <group>
                                <separator string="Schedule Information"/>
                                <div class="o_form_label">Venezuelan bi-monthly payroll schedule</div>
                                <div class="o_form_label">Standard: 15th and 31st (or last day) of each month</div>
                                <div class="o_form_label">24 payroll periods per year</div>
                            </group>
                        </group>
                    </page>

                </page>

                <!-- Hide contract type field to prevent errors -->
                <field name="contract_type_id" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
            </field>
        </record>

        <!-- Extend HR Contract Tree View -->
        <record id="hr_contract_view_tree_venezuelan" model="ir.ui.view">
            <field name="name">hr.contract.tree.venezuelan</field>
            <field name="model">hr.contract</field>
            <field name="inherit_id" ref="hr_contract.hr_contract_view_tree"/>
            <field name="priority">99</field>
            <field name="arch" type="xml">
                <!-- Add Venezuelan fields to tree view -->
                <field name="wage" position="after">
                    <field name="ueipab_salary_base" string="Salary" optional="show"/>
                    <field name="ueipab_bonus_regular" string="Bonus" optional="show"/>
                    <field name="cesta_ticket_usd" string="Cesta Ticket" optional="hide"/>
                </field>
            </field>
        </record>
    </data>
</odoo>